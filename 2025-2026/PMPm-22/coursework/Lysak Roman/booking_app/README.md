# Веб-додаток для бронювання з AI-асистентом

Інтелектуальна система бронювання послуг з інтеграцією Microsoft Bookings та AI-асистентом на базі Google Gemini.

## Опис проекту

Цей веб-додаток створено для спрощення процесу бронювання різноманітних послуг (залів, майстер-класів, консультацій тощо) через централізовану платформу. Додаток інтегрується з Microsoft Bookings для управління бронюваннями та використовує Google Gemini AI для надання інтелектуальної підтримки користувачам українською мовою.

## Основні можливості

### Управління бронюваннями
- Перегляд доступних послуг з різних бізнесів
- Детальна інформація про кожну послугу (опис, тривалість, ціна)
- Швидке бронювання через публічні посилання Microsoft Bookings
- Перегляд своїх активних зустрічей
- Скасування зустрічей через інтерфейс

### AI-асистент (Gemini)
- Інтелектуальний чат-бот з підтримкою української мови
- Пошук послуг за допомогою природних запитів
- Автоматичні рекомендації на основі потреб користувача
- Відповіді на питання про бронювання та послуги
- Інформація про найближчі зустрічі
- Допомога в скасуванні бронювань
- Нечіткий пошук за назвою послуги (Fuse.js)

### Автентифікація та безпека
- Захищена автентифікація через Microsoft Azure AD (MSAL)
- Персоналізований доступ до своїх бронювань
- Захист персональних даних користувача

## Технологічний стек

### Frontend
- **React 19** - бібліотека для створення користувацького інтерфейсу
- **Styled Components** - стилізація компонентів
- **React Context API** - управління глобальним станом
- **Axios** - HTTP-клієнт для API запитів

### Автентифікація
- **@azure/msal-react** - Microsoft Authentication Library
- **@azure/msal-browser** - браузерна версія MSAL

### AI та пошук
- **@google/genai** - Google Gemini AI API
- **Fuse.js** - нечіткий пошук для покращеної точності

### UI Компоненти
- **@fluentui/react** - Microsoft Fluent UI Design System
- **react-markdown** - рендеринг Markdown відповідей від AI

### Інструменти розробки
- **Create React App** - інструмент для створення React додатків
- **Babel** - транспайлер JavaScript

## Встановлення та налаштування

### Передумови
- Node.js (версія 14 або вище)
- npm або yarn
- Обліковий запис Microsoft Azure з налаштованим додатком
- Google Gemini API ключ

### Крок 1: Клонування репозиторію
```bash
git clone <repository-url>
cd bookings-web-app
```

### Крок 2: Встановлення залежностей
```bash
npm install
```

### Крок 3: Налаштування змінних середовища

Створіть файл `.env.local` в кореневій директорії проекту:

```env
# Microsoft Azure AD Configuration
REACT_APP_CLIENT_ID=your_azure_client_id
REACT_APP_TENANT_ID=your_azure_tenant_id

# Google Gemini AI API Key
REACT_APP_GEMINI_API_KEY=your_gemini_api_key
```

### Крок 4: Налаштування Azure AD

1. Створіть додаток в [Azure Portal](https://portal.azure.com)
2. Налаштуйте Redirect URI: `http://localhost:3000`
3. Додайте необхідні дозволи для Microsoft Graph API:
   - `Bookings.Read.All`
   - `Bookings.ReadWrite.All`
   - `User.Read`
4. Скопіюйте Application (client) ID та Directory (tenant) ID

### Крок 5: Отримання Gemini API ключа

Детальні інструкції дивіться у файлі [GEMINI_SETUP.md](./GEMINI_SETUP.md)

### Крок 6: Налаштування доступних бронювань

Відредагуйте файл `src/allowedBookings.js` та додайте ID ваших Microsoft Bookings бізнесів:

```javascript
export const ALLOWED_BOOKINGS = {
  "booking_id_1": "Назва послуги 1",
  "booking_id_2": "Назва послуги 2",
  // Add more if needed
};
```

### Крок 7: Запуск додатку

```bash
npm start
```

Додаток буде доступний за адресою [http://localhost:3000](http://localhost:3000)

## Структура проекту

```
bookings-web-app/
├── public/                      # Статичні файли
├── src/
│   ├── components/              # React компоненти
│   │   ├── App.js              # Головний компонент додатку
│   │   ├── App_Styled.js       # Стилі для App
│   │   ├── Bookings/           # Компонент списку бронювань
│   │   └── ChatWidget/         # AI чат-віджет
│   ├── shared_components/       # Спільні компоненти
│   │   ├── Button/             # Кнопка
│   │   ├── Calendar/           # Календар
│   │   ├── TimeSlotPicker/     # Вибір часу
│   │   ├── BookingRequestModal/    # Модальне вікно бронювання
│   │   └── AppointmentsModal/      # Модальне вікно зустрічей
│   ├── contexts/                # React Context
│   │   ├── BookingsContext.js  # Контекст бронювань
│   │   └── LLMContext.js       # Контекст AI чату
│   ├── services/                # Сервіси
│   │   └── geminiService.js    # Інтеграція з Gemini AI
│   ├── static/                  # Зображення та статика
│   ├── allowedBookings.js       # Конфігурація доступних бронювань
│   ├── authConfig.js            # Конфігурація Azure AD
│   ├── index.js                 # Точка входу
│   └── index.css                # Глобальні стилі
├── .env.local                   # Змінні середовища (не в git)
├── package.json                 # Залежності проекту
├── README.md                    # Цей файл
└── GEMINI_SETUP.md             # Інструкції по налаштуванню Gemini AI
```

## Доступні скрипти

### `npm start`
Запускає додаток у режимі розробки. Відкрийте [http://localhost:3000](http://localhost:3000) у браузері.

### `npm test`
Запускає тестовий раннер у інтерактивному режимі.

### `npm run build`
Створює оптимізовану production збірку в папці `build/`.

### `npm run eject`
**Увага: це одностороння операція!** Після виконання `eject` не можна повернутися назад.

## Використання

### Автентифікація
1. Відкрийте додаток у браузері
2. Натисніть кнопку "Увійти"
3. Авторизуйтесь через Microsoft Azure AD
4. Після успішної автентифікації ви побачите доступні послуги

### Перегляд послуг
- Всі доступні послуги відображаються на головній сторінці
- Кожна карточка містить інформацію про назву, опис та послуги бізнесу
- Натисніть "Переглянути послуги" для деталей

### Бронювання
1. Виберіть послугу, яку хочете забронювати
2. Натисніть "Забронювати" або використайте посилання з AI-асистента
3. Заповніть форму бронювання в Microsoft Bookings
4. Підтвердіть бронювання

### Використання AI-асистента
Чат-віджет розташований у правому нижньому куті екрану. Приклади запитів:

- "Що я можу зарезервувати?"
- "Де я можу знайти бронювання волейбольного залу?"
- "Як зробити резервацію?"
- "Які зустрічі я маю?"
- "Коли моя найближча зустріч?"
- "Скасувати зустріч 1"

### Перегляд своїх зустрічей
1. Натисніть кнопку "Мої зустрічі" у правому верхньому куті
2. Перегляньте список своїх активних бронювань
3. За потреби скасуйте зустріч через кнопку "Скасувати"

## API та інтеграції

### Microsoft Graph API
- **Bookings API** - отримання списку бізнесів, послуг та зустрічей
- **Authentication** - автентифікація користувачів через Azure AD

### Google Gemini API
- **Model:** `gemini-2.5-flash-lite`
- **Функції:**
  - Обробка природних запитів українською мовою
  - Генерація відповідей на запитання про бронювання
  - Пошук послуг за описом
  - Форматування інформації для користувача

## Особливості реалізації

### Контекст бронювань (BookingsContext)
Централізоване управління даними:
- Отримання списку бронювань з Microsoft Bookings
- Фільтрація за дозволеними ID
- Кешування даних для продуктивності
- Управління зустрічами користувача

### LLM Контекст (LLMContext)
Управління станом чату:
- Історія повідомлень
- Стан завантаження
- Обробка помилок
- Інтеграція з Gemini API

### Нечіткий пошук (Fuse.js)
- Threshold: 0.4 (оптимально для української мови)
- Пошук за назвою послуги
- Толерантність до помилок та опечаток

## Безпека

- Всі API ключі зберігаються у змінних середовища
- Автентифікація через Microsoft Azure AD
- Захист персональних даних користувача
- HTTPS для всіх API запитів

## Обмеження та квоти

### Microsoft Graph API
- Залежить від вашої підписки Azure
- Рекомендовано використовувати кешування

### Google Gemini API (Free Tier)
- 60 запитів на хвилину
- 1,500 запитів на день
- Безкоштовно для невеликого та середнього використання

## Усунення несправностей

### Помилка "API key not configured"
- Перевірте наявність файлу `.env.local`
- Переконайтеся, що змінна починається з `REACT_APP_`
- Перезапустіть dev сервер після додавання ключа

### Помилка автентифікації Azure AD
- Перевірте правильність CLIENT_ID та TENANT_ID
- Переконайтеся, що Redirect URI налаштовано в Azure Portal
- Перевірте, що додано всі необхідні дозволи

### Помилка "Failed to fetch bookings"
- Перевірте інтернет з'єднання
- Переконайтеся, що ваш обліковий запис має доступ до Microsoft Bookings
- Перевірте правильність ID у `allowedBookings.js`

### AI-асистент відповідає не українською
- Системний промпт налаштовано на українську мову
- Спробуйте переформулювати запитання
- Перевірте валідність API ключа Gemini

## Майбутні покращення

- Пряме бронювання через чат без переходу на зовнішні посилання
- Підтримка кількох мов (англійська, польська)
- Голосове введення запитів
- Інтеграція з календарями (Google Calendar, Outlook)
- Push-повідомлення про найближчі зустрічі
- Адміністративна панель для управління бронюваннями

## Підтримка

Для питань та звітів про помилки, будь ласка, створіть issue в репозиторії проекту.

## Ліцензія

Цей проект створено для освітніх цілей.

## Корисні посилання

- [Microsoft Graph API Documentation](https://docs.microsoft.com/en-us/graph/)
- [Microsoft Bookings API](https://docs.microsoft.com/en-us/graph/api/resources/booking-api-overview)
- [Google Gemini AI Documentation](https://ai.google.dev/docs)
- [Azure AD App Registration](https://portal.azure.com)
- [React Documentation](https://react.dev/)
- [Styled Components](https://styled-components.com/)

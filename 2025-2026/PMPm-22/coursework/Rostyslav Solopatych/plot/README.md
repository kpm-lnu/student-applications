# Plot Utilities

This directory contains visualization scripts for the diffusion inverse problem project.

## Scripts

### `plot_epoch_losses.py`

Plot training and validation losses from epoch_losses.json files generated during model training.

#### Description

This script reads the epoch losses JSON file produced by the physics training loop and generates a publication-quality plot showing training and validation losses over epochs.

The script creates one output file:

- `epoch_losses.png`: Single plot showing training and validation losses

#### Usage

```bash
python plot/plot_epoch_losses.py <json_file> --batch_size <bs> --learning_rate <lr> --pixel_res <pixels> [--output_dir <dir>]
```

#### Required Arguments

- `json_file`: Path to the `epoch_losses.json` file (can be `training_epoch_losses.json` or similar)
- `--batch_size`: Batch size used during training (e.g., 128)
- `--learning_rate`: Learning rate used during training (e.g., 0.001)
- `--pixel_res`: Grid resolution / number of pixels (e.g., 64)

#### Optional Arguments

- `--output_dir`: Directory to save the plots (default: same directory as the JSON file)

#### Examples

**Basic usage** (saves plots to the same directory as the JSON file):

```bash
python plot/plot_epoch_losses.py \
  ./checkpoints/epoch_losses.json \
  --batch_size 128 \
  --learning_rate 0.001 \
  --pixel_res 64
```

**From grid search results**:

```bash
python plot/plot_epoch_losses.py \
  /path/to/grid_search_results/checkpoints/bs128_lr0.001_ss64/epoch_losses.json \
  --batch_size 128 \
  --learning_rate 0.001 \
  --pixel_res 64
```

**Custom output directory**:

```bash
python plot/plot_epoch_losses.py \
  ./checkpoints/training_epoch_losses.json \
  --batch_size 64 \
  --learning_rate 0.0001 \
  --pixel_res 128 \
  --output_dir ./figures
```

#### Output Files

The script generates a single PNG file in the output directory:

**`epoch_losses.png`**:

- Single plot showing training and validation losses
- Title includes hyperparameters (batch size, learning rate, pixels)
- Grid lines for easier reading
- Legend identifying train vs validation curves
- Markers on data points for clarity
- High resolution (300 DPI) for publication quality

#### Plot Title Format

The plots include a title with the training hyperparameters:

```
Training and Validation Losses: BS: {batch_size}; LR: {learning_rate}; Pixels: {pixel_res}
```

This makes it easy to identify which experiment the plots correspond to.

#### Input File Format

The script expects a JSON file with the following structure:

```json
{
  "epoch_losses": [
    {
      "epoch": 1,
      "train_diffusion_loss": 0.05599,
      "train_total_loss": 0.05599,
      "val_diffusion_loss": 0.01671,
      "val_total_loss": 0.01671
    },
    ...
  ]
}
```

This format is automatically generated by `model/physics_training_loop.py` when training completes.

#### Dependencies

- `matplotlib`: For plotting
- `json`: For reading JSON files (standard library)
- `argparse`: For command-line arguments (standard library)

Install matplotlib if not already available:

```bash
pip install matplotlib
```

## Related Scripts

- `../model/physics_training_loop.py`: Generates the epoch_losses.json files
- `../dataset/generate_harmonic_dataset.py`: Generates training datasets
